(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[997],{4060:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s(5155),i=s(2115),r=s(6597),l=s(851);s(8047);let a=(0,l.UU)("https://ilytpvgngoniasezntau.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlseXRwdmduZ29uaWFzZXpudGF1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc5NjIzMTAsImV4cCI6MjA2MzUzODMxMH0.mWvYffpUzrdqK5Kfp-tHb4KmG6U4llTisqKu1_7RBKY");function o(){let[e,t]=(0,i.useState)(null),[s,l]=(0,i.useState)([]),[o,c]=(0,i.useState)(null),[u,d]=(0,i.useState)(!0);(0,i.useEffect)(()=>{!async function(){let{data:e}=await a.auth.getSession();if(!e.session){alert("Vous n'\xeates pas connect\xe9 !"),window.location.href="/connexion";return}let s=e.session.user.email,{data:n}=await a.from("utilisateurs").select("id, nom, email, role").eq("email",s).single();n?(t(n),c(n.role)):alert("Erreur de chargement du profil");let{data:i}=await a.from("reservations").select("*").eq("utilisateur_id",null==n?void 0:n.id);i&&l(i),d(!1)}()},[]);let h=async()=>{await a.auth.signOut(),localStorage.removeItem("userId"),localStorage.removeItem("role"),window.location.href="/"};return u?(0,n.jsx)("p",{children:"Chargement..."}):o?(0,n.jsxs)("div",{className:"page-container",children:[(0,n.jsx)("h1",{children:"Mon profil"}),e&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Nom : "}),e.nom]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Email : "}),e.email]})]}),(0,n.jsx)("h2",{children:"R\xe9servations"}),0===s.length?(0,n.jsx)("p",{children:"Aucune r\xe9servation"}):(0,n.jsxs)("p",{children:[s.length," r\xe9servation(s)."]}),"client"===o&&(0,n.jsx)("button",{className:"button",onClick:()=>{if(0===s.length)return void alert("Aucune r\xe9servation disponible pour g\xe9n\xe9rer le PDF.");let e=new r.uE,t=10;e.setFontSize(16),e.text("Vos e-tickets",10,t),t+=10,s.forEach((s,n)=>{e.setFontSize(14),e.text("R\xe9servation #".concat(s.id),10,t),t+=8}),e.save("etickets.pdf")},children:"T\xe9l\xe9charger vos e-tickets (PDF)"}),(0,n.jsx)("button",{className:"button",onClick:h,children:"D\xe9connexion"})]}):(0,n.jsx)("p",{children:"Acc\xe8s non autoris\xe9"})}},5701:(e,t,s)=>{Promise.resolve().then(s.bind(s,4060))},8047:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[750,930,851,913,441,684,358],()=>t(5701)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1544:(e,s,t)=>{Promise.resolve().then(t.bind(t,7161))},7026:()=>{},7161:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var a=t(5155),r=t(2115);function n(){let[e,s]=(0,r.useState)([]),[t,n]=(0,r.useState)(""),[l,i]=(0,r.useState)(""),[c,o]=(0,r.useState)(0),[u,h]=(0,r.useState)(1),[d,p]=(0,r.useState)(""),[m,f]=(0,r.useState)([]),[j,x]=(0,r.useState)(""),[N,g]=(0,r.useState)(""),[v,E]=(0,r.useState)(""),[b,C]=(0,r.useState)(""),[S,y]=(0,r.useState)(""),D=()=>{fetch("http://127.0.0.1:5000/offres").then(e=>e.json()).then(e=>s(e)).catch(e=>console.error("Erreur fetching offres:",e))},k=()=>{fetch("http://127.0.0.1:5000/utilisateurs").then(e=>e.json()).then(e=>{f(e.filter(e=>"employe"===e.role))}).catch(e=>console.error("Erreur fetch utilisateurs:",e))};(0,r.useEffect)(()=>{if("admin"!==localStorage.getItem("role")){alert("Acc\xe8s non autoris\xe9"),window.location.href="/";return}D(),k()},[]);let O=e=>{fetch("http://127.0.0.1:5000/offres/".concat(e),{method:"DELETE"}).then(e=>{e.ok?(p("\uD83D\uDD34 Offre supprim\xe9e"),D()):p("\uD83D\uDD34 Erreur lors de la suppression")}).catch(()=>p("\uD83D\uDD34 Erreur r\xe9seau"))},_=e=>{fetch("http://127.0.0.1:5000/utilisateur/".concat(e),{method:"DELETE"}).then(s=>{s.ok?(y("Utilisateur ".concat(e," supprim\xe9")),k()):y("Erreur lors de la suppression")}).catch(()=>y("Erreur r\xe9seau"))};return(0,a.jsxs)("div",{className:"page-container",children:[(0,a.jsx)("h1",{className:"page-header",children:"\uD83D\uDEE0️ Gestion Admin des Offres"}),(0,a.jsxs)("section",{className:"section",children:[(0,a.jsx)("h2",{children:"Liste des offres"}),0===e.length?(0,a.jsx)("p",{children:"Aucune offre disponible."}):e.map(e=>(0,a.jsxs)("div",{className:"offre-item",children:[(0,a.jsxs)("div",{className:"offre-details",children:[(0,a.jsx)("h3",{className:"offre-title",children:e.nom}),(0,a.jsx)("p",{className:"offre-desc",children:e.description}),(0,a.jsxs)("small",{className:"offre-info",children:["Prix : ",e.prix," € | Capacit\xe9 : ",e.capacite]})]}),(0,a.jsx)("button",{className:"btn btn-delete",onClick:()=>O(e.id),children:"Supprimer"})]},e.id))]}),(0,a.jsxs)("section",{className:"section",children:[(0,a.jsx)("h2",{children:"\uD83D\uDCDD Ajouter une nouvelle offre"}),(0,a.jsxs)("div",{className:"form-container",children:[(0,a.jsx)("input",{className:"input-field",placeholder:"Nom",value:t,onChange:e=>n(e.target.value)}),(0,a.jsx)("textarea",{className:"input-field",placeholder:"Description",value:l,onChange:e=>i(e.target.value)}),(0,a.jsx)("input",{className:"input-field",type:"number",placeholder:"Prix (€)",value:c,onChange:e=>o(parseFloat(e.target.value))}),(0,a.jsx)("input",{className:"input-field",type:"number",placeholder:"Capacit\xe9",value:u,onChange:e=>h(parseInt(e.target.value))}),(0,a.jsx)("button",{className:"btn btn-add",onClick:()=>{fetch("http://127.0.0.1:5000/offres",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nom:t,description:l,prix:c,capacite:u})}).then(e=>e.json()).then(e=>{p("\uD83D\uDFE2 Offre ajout\xe9e avec succ\xe8s"),D(),n(""),i(""),o(0),h(1)}).catch(()=>p("\uD83D\uDD34 Erreur lors de l'ajout"))},children:"Ajouter Offre"}),d&&(0,a.jsx)("p",{className:"message ".concat(d.startsWith("\uD83D\uDFE2")?"message-success":"message-error"),children:d})]})]}),(0,a.jsx)("h2",{children:"Liste des Employ\xe9s"}),0===m.length?(0,a.jsx)("p",{children:"Aucun employ\xe9."}):m.map(e=>(0,a.jsxs)("div",{className:"user-item",children:[(0,a.jsxs)("p",{children:[e.nom," ",e.prenom," - ",e.email]}),(0,a.jsx)("button",{className:"btn btn-delete",onClick:()=>_(e.id),children:"Supprimer"})]},e.id)),(0,a.jsx)("h2",{children:"\uD83D\uDCDD Ajouter un Employ\xe9"}),(0,a.jsxs)("div",{className:"form-container",children:[(0,a.jsx)("input",{className:"input-field",placeholder:"Nom",value:j,onChange:e=>x(e.target.value)}),(0,a.jsx)("input",{className:"input-field",placeholder:"Pr\xe9nom",value:N,onChange:e=>g(e.target.value)}),(0,a.jsx)("input",{className:"input-field",placeholder:"Email",type:"email",value:v,onChange:e=>E(e.target.value)}),(0,a.jsx)("input",{className:"input-field",placeholder:"Mot de passe",type:"password",value:b,onChange:e=>C(e.target.value)}),(0,a.jsx)("button",{className:"btn btn-add",onClick:()=>{fetch("http://127.0.0.1:5000/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nom:j,prenom:N,email:v,mot_de_passe:b,role:"employe"})}).then(e=>e.json()).then(e=>{e.user_id?(y("Employ\xe9 ajout\xe9 avec succ\xe8s"),k(),x(""),g(""),E(""),C("")):y("Erreur : "+(e.error||""))}).catch(()=>y("Erreur r\xe9seau"))},children:"Ajouter Employ\xe9"}),S&&(0,a.jsx)("p",{className:"message",children:S})]})]})}t(7026)}},e=>{var s=s=>e(e.s=s);e.O(0,[971,441,684,358],()=>s(1544)),_N_E=e.O()}]);